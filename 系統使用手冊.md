# 電聯記錄簿管理系統 - 完整使用手冊

> **學校**: 林口康橋國際學校 小學國際處 (KCISLK ESID)  
> **製作人**: 陳則宏 Jason Chen  
> **專為林口康橋國際學校小學國際處設計的電聯記錄簿管理系統**

## 📋 系統概述

電聯記錄簿管理系統是一個基於 Google Apps Script 的自動化解決方案，專門為林口康橋國際學校小學國際處設計，用於管理與家長的聯繫記錄。系統提供一鍵批量建立、智能資料提取、視覺化管理面板等創新功能，讓國際處的電聯管理工作更加高效便捷。

### 🎯 林口康橋國際學校小學國際處特色優化
- **一鍵批量建立**：從學生總表自動提取所有英文老師資訊並建立記錄簿
- **智能資料分配**：自動從 LT 欄位識別老師，並將對應學生資料匯入各自記錄簿
- **簡化操作流程**：無需重複輸入科目，系統自動設定為「英文」
- **視覺化管理**：提供 Dashboard 管理面板，支援集中式操作

## ✨ 主要功能

### 🏗️ 自動化建立
- **一鍵初始化**：自動建立完整的資料夾結構和範本檔案
- **從學生總表批量建立**：從學生總表的 LT 欄位自動提取英文老師並建立記錄簿
- **智能資料匯入**：為每位老師自動匯入對應的學生資料
- **傳統批次建立**：支援手動輸入老師資料的批次建立方式
- **範本檔案管理**：提供標準化的記錄格式範本

### 📝 記錄管理
- **學期制格式**：採用11欄位格式，包含Student ID, Name, English Name, English Class, Date, Semester, Term, Contact Type, Teachers Content, Parents Responses, Contact Method
- **學期追蹤**：支援Fall/Spring學期，Beginning/Midterm/Final三個term進度追蹤
- **電聯分類**：學期電聯（納入進度）、平時電聯、特殊狀況電聯三種類型
- **資料驗證**：下拉選單確保資料一致性
- **條件式格式**：聯絡方式顏色標示，一目了然
- **自動統計**：即時計算學期進度統計數據

### 👥 學生資料管理  
- **智能老師識別**：自動從學生總表的 LT（Local Teacher）欄位識別英文老師
- **自動資料分配**：根據 LT 欄位自動將學生分配到對應老師的記錄簿
- **學生總表匯入**：支援從現有學生總表匯入資料，包含ID, Grade, HR, Seat #, Chinese Name, English Name等欄位
- **批次資料處理**：可從Google Sheets或手動輸入學生資料
- **快速電聯建立**：從學生清單快速選擇並建立電聯記錄
- **資料匯出功能**：將學生資料匯出為新的Google Sheets檔案

### 📊 進度追蹤
- **學期制進度**：以學期/term為單位追蹤學期電聯完成度
- **自動檢查**：定期檢查老師學期電聯記錄進度
- **智能提醒**：超過設定天數未記錄自動提醒
- **狀態分類**：正常、待改善、需關注三級分類
- **詳細報告**：生成完整的學期進度分析報告

### 🔧 系統管理
- **統一Dashboard管理面板**：完整的視覺化管理介面，支援所有系統功能
- **系統設定查看**：視覺化系統設定顯示，包含健康度、資料夾配置、學年設定等
- **完整Web環境**：所有功能統一在Dashboard中執行，無需環境切換
- **自動備份**：定期備份重要資料
- **系統維護**：自動清理和優化
- **統計分析**：多維度數據分析
- **批量操作監控**：即時顯示批量建立進度和結果

## 📁 檔案結構

```
電聯記錄簿系統/
├── Code.gs                    # 主程式和系統初始化
├── TeacherManagement.gs       # 老師管理功能（已針對英文科優化）
├── StudentDataImport.gs       # 學生資料匯入和批量建立功能
├── ProgressTracking.gs        # 進度檢查和報告
├── SystemUtils.gs            # 系統工具和設定
├── AutomationTriggers.gs     # 自動化觸發器
├── DashboardController.gs    # Dashboard 後端控制器（可選）
├── dashboard.html            # 視覺化管理面板（可選）
└── 系統使用手冊.md           # 完整使用手冊（本文件）
```

---

# 📥 安裝指南

## 🎯 安裝前準備

### 必要條件
- 擁有 Google 帳號
- 具備 Google Drive 和 Google Sheets 的基本操作能力
- 瀏覽器建議使用 Chrome 或 Edge
- 準備學生總表（包含 LT 欄位的 Google Sheets）

### 權限需求
- Google Drive 檔案讀寫權限
- Google Sheets 建立和編輯權限
- Gmail 發送權限（可選，用於通知功能）

### 新功能特色
- 🚀 **一鍵批量建立**：從學生總表自動建立所有英文老師的記錄簿
- 🎨 **視覺化管理面板**：提供友善的 Dashboard 操作界面
- 📋 **智能資料提取**：自動從學生總表的 LT 欄位識別英文老師
- 🔄 **簡化操作流程**：針對林口康橋國際學校小學國際處優化，無需手動輸入科目

## 📥 步驟一：建立 Google Apps Script 專案

### 1.1 開啟 Google Apps Script
1. 前往 [https://script.google.com/](https://script.google.com/)
2. 使用您的 Google 帳號登入
3. 點選左上角的「新增專案」

### 1.2 設定專案名稱
1. 點選左上角的「未命名專案」
2. 將專案名稱改為：`電聯記錄簿系統`
3. 按 Enter 確認

## 📝 步驟二：加入程式碼

### 2.1 準備程式檔案
您需要建立以下檔案：

**必要檔案（6個 .gs 檔案）：**
1. `Code.gs` - 主程式和系統初始化
2. `TeacherManagement.gs` - 老師管理功能（已針對英文科優化）
3. `StudentDataImport.gs` - 學生資料匯入和批量建立功能
4. `ProgressTracking.gs` - 進度檢查和報告
5. `SystemUtils.gs` - 系統工具和設定
6. `AutomationTriggers.gs` - 自動化觸發器

**可選檔案（Dashboard 管理面板）：**
7. `DashboardController.gs` - Dashboard 後端控制器
8. `dashboard.html` - Dashboard 前端介面

### 2.2 建立檔案步驟

#### 第一個檔案：Code.gs
1. 刪除預設的 `Code.gs` 中的所有內容
2. 複製本專案中 `Code.gs` 的全部程式碼
3. 貼上到編輯器中
4. 按 `Ctrl+S` 儲存

#### 其他檔案：
1. 點選左側的「+」新增檔案
2. 選擇「指令碼」
3. 將檔案名稱改為對應名稱（如：`TeacherManagement`）
4. 複製對應的程式碼並貼上
5. 儲存檔案

重複以上步驟建立所有檔案。

### 2.3 設定 Dashboard 管理面板（可選）
1. 建立 `DashboardController.gs` 檔案並複製對應程式碼
2. 建立 `dashboard.html` 檔案並複製對應程式碼
3. 部署為 Google Apps Script Web 應用程式

**重要**：Dashboard 提供完整的統一Web管理界面，包含所有系統功能。所有操作都可以在Dashboard中完成，Google Sheets選單作為替代方案保留。

## 🔐 步驟三：設定權限

### 3.1 第一次執行
1. 在編輯器中選擇 `Code.gs`
2. 在函數下拉選單中選擇 `initializeSystem`
3. 點選「執行」按鈕（播放圖示）

### 3.2 授權流程
1. 第一次執行會要求授權
2. 點選「檢閱權限」
3. 選擇您的 Google 帳號
4. 點選「進階」
5. 點選「前往電聯記錄簿系統（不安全）」
6. 點選「允許」授權以下權限：
   - 查看和管理您的 Google Drive 檔案
   - 建立、編輯 Google Sheets
   - 以您的身分傳送電子郵件（可選）

### 3.3 驗證權限
權限設定成功後，您會看到「已授權」的訊息。

## 🏗️ 步驟四：初始化系統

### 4.1 執行初始化
1. 確認 `initializeSystem` 函數被選中
2. 再次點選「執行」按鈕
3. 等待執行完成（約 30-60 秒）

### 4.2 檢查初始化結果
初始化成功後，系統會顯示成功訊息，並提供：
- 主資料夾連結
- 管理控制台連結
- **學生總表連結**（新增功能）

**重要**：建議先開啟學生總表，將您的學生資料貼上後再進行後續操作。

### 4.3 驗證資料夾結構
前往您的 Google Drive，應該會看到：
```
電聯記錄簿系統/
├── 老師記錄簿/
├── 範本檔案/
├── 系統備份/
├── 進度報告/
├── 電聯記錄簿範本
├── 電聯記錄簿管理控制台
└── 學生總表（新增）
```

## 👥 步驟五：批量建立老師記錄簿（推薦）

### 5.1 準備學生總表
系統初始化時已自動建立學生總表範本，您只需要：

1. **開啟學生總表**：點選初始化完成訊息中的學生總表連結
2. **檢視範本格式**：查看「使用說明」工作表了解欄位說明
3. **貼上學生資料**：在「學生資料」工作表的第4列開始貼上您的資料
4. **確認 LT 欄位**：確保每位學生的 LT 欄位都填入正確的英文老師姓名

**學生總表包含以下欄位：**
- **LT 欄位**：本地老師姓名（Local Teacher）- 🔥 最重要！
- **English Class 欄位**：英語授課班級（如：G1 Trailblazers）- 🔥 決定老師班級！
- **HR 欄位**：原班級資訊（僅供參考）
- **Grade 欄位**：年級（G1-G6）
- **其他學生基本資料**：ID、姓名、聯絡方式等

### 5.2 使用批量建立功能

#### 方法一：透過 Dashboard（推薦）
1. 開啟 Dashboard Web 應用程式
2. 點選「從學生總表建立老師記錄簿」
3. 輸入學生總表 ID
4. 點選「開始處理」
5. 系統會自動：
   - 提取所有英文老師名單
   - 顯示確認清單（包含每位老師的班級和學生數）
   - 為每位老師建立專屬記錄簿
   - 自動匯入對應的學生資料

**提示**：學生總表的 ID 可以從瀏覽器網址列中複製，格式如：
`https://docs.google.com/spreadsheets/d/1ABC...XYZ/edit`
其中 `1ABC...XYZ` 就是 Google Sheets ID

#### 方法二：透過 Google Sheets 選單（替代方案）
1. 開啟任意一個 Google Sheets（或建立新的）
2. 在選單列中應該會看到「電聯記錄簿系統」選單
3. 如果沒有看到，請重新整理頁面
4. 點選「電聯記錄簿系統」選單
5. 選擇「📋 從學生總表建立老師記錄簿」
6. 輸入學生總表的 Google Sheets ID（可從網址列複製）
7. 按照系統提示完成操作

### 5.3 單一老師記錄簿建立

#### 方法一：透過 Dashboard（推薦）
1. 開啟 Dashboard Web 應用程式
2. 點選「建立單一老師記錄簿」
3. 在彈出的表單中輸入：
   - 老師姓名：例如「王小明」
   - 授課班級：例如「701,702,703」
4. 點選「建立記錄簿」

#### 方法二：透過 Google Sheets 選單（替代方案）
1. 點選「電聯記錄簿系統」選單
2. 選擇「👨‍🏫 新增老師記錄簿」
3. 依序輸入：
   - 老師姓名：例如「王小明」
   - 授課班級：例如「701,702,703」
   
**注意**：系統已自動設定科目為「英文」，無需手動輸入。

### 5.4 檢查建立結果
批量建立完成後，系統會：
1. 為每位老師建立專屬資料夾
2. 建立完整的記錄簿檔案（包含5個工作表）
3. 自動匯入對應的學生資料
4. 顯示成功訊息和統計資料

## 🔄 步驟六：設定自動化（可選）

### 6.1 開啟 Google Apps Script 專案
1. 回到您的 Google Apps Script 專案
2. 在函數下拉選單中選擇 `setupAutomationTriggers`
3. 點選「執行」

### 6.2 確認自動化設定
系統會設定以下自動化功能：
- 每週一早上 8 點：自動進度檢查
- 每月 1 號早上 9 點：生成學期進度報告
- 每日凌晨 2 點：系統備份
- 每週日凌晨 3 點：系統維護

---

# 🎨 Dashboard 部署指南

## 📋 部署概述

Dashboard 透過 Google Apps Script 部署為 Web 應用程式，提供完整的統一管理介面。管理員可以透過瀏覽器直接存取所有系統功能，享受一致的操作體驗。

## 🚀 部署步驟

### 步驟一：準備檔案

確認您的 Google Apps Script 專案中包含 `DashboardController.gs` 和 `dashboard.html` 檔案。

### 步驟二：加入 Dashboard 檔案

#### 2.1 加入 DashboardController.gs
1. 在 Google Apps Script 編輯器中點選「+」→「指令碼」
2. 將檔案名稱改為 `DashboardController`
3. 複製 `DashboardController.gs` 的內容並貼上
4. 儲存檔案

#### 2.2 加入 dashboard.html
1. 在 Google Apps Script 編輯器中點選「+」→「HTML」
2. 將檔案名稱改為 `dashboard`
3. 複製 `dashboard.html` 的內容並貼上
4. 儲存檔案

### 步驟三：部署 Web 應用程式

#### 3.1 開始部署
1. 在 Google Apps Script 編輯器中，點選右上角的「部署」→「新增部署作業」

#### 3.2 選擇部署類型
1. 點選「類型」→「Web 應用程式」

#### 3.3 設定部署參數
1. **說明**：輸入 `電聯記錄簿系統 Dashboard v1.0`
2. **執行身分**：選擇「我」
3. **具備存取權的使用者**：
   - 如果只有您使用：選擇「僅限我自己」
   - 如果要給其他老師使用：選擇「任何人」

#### 3.4 完成部署
1. 點選「部署」
2. 授權必要的權限
3. 複製 Web 應用程式 URL

### 步驟四：測試部署

1. 開啟部署後獲得的 Web 應用程式 URL
2. 確認 Dashboard 介面正常顯示
3. 測試各項功能

## ⚙️ Dashboard 功能說明

### 完全支援的功能（統一Dashboard架構）
- ✅ **系統初始化**：建立資料夾結構和範本
- ✅ **從學生總表建立老師記錄簿**：完整的Web版本實現，支援批量建立和學生資料自動匯入
- ✅ **建立單一老師記錄簿**：輸入老師資訊並建立記錄簿
- ✅ **學生資料匯入/匯出**：完整的Web版本實現，支援資料匯入和匯出功能
- ✅ **系統設定查看**：視覺化系統設定介面，顯示系統健康度、資料夾配置、學年設定等
- ✅ **開啟系統資料夾**：直接開啟 Google Drive 資料夾
- ✅ **系統統計**：即時顯示老師數、學生數、電聯記錄數等
- ✅ **進度檢查**：檢查全體電聯進度
- ✅ **自動化設定**：設定自動觸發器
- ✅ **系統備份**：執行手動備份
- ✅ **檔案完整性檢查**：檢查系統檔案狀態

### 🎯 統一架構優勢
- **無環境切換困擾**：所有功能統一在Dashboard中執行
- **操作流程簡化**：一致的用戶體驗，降低學習成本
- **功能完整性**：Web版本功能與原有功能完全一致
- **維護便利性**：單一架構，減少維護複雜度

---

# 📖 使用說明

## 快速開始（林口康橋國際學校小學國際處）

1. **系統初始化**
   ```
   選單 → 電聯記錄簿系統 → 🏗️ 初始化系統
   ```

2. **一鍵批量建立記錄簿**（推薦）
   ```
   選單 → 電聯記錄簿系統 → 📋 從學生總表建立老師記錄簿
   ```

3. **建立單一老師記錄簿**
   ```
   選單 → 電聯記錄簿系統 → 👨‍🏫 新增老師記錄簿
   ```

4. **進度檢查**
   ```
   選單 → 電聯記錄簿系統 → 📊 檢查全體進度
   ```

### Dashboard 使用（推薦）

1. 開啟 Dashboard Web 應用程式 URL
2. 使用統一的視覺化介面進行所有操作
3. 即時查看系統統計和進度
4. 查看完整的系統設定資訊
5. 執行批量建立和資料匯入/匯出功能

## 詳細操作

### 從學生總表批量建立（推薦）

1. **準備學生總表**：確保包含 LT（Local Teacher）欄位
2. **執行批量建立**：
   - 點選選單中的「📋 從學生總表建立老師記錄簿」
   - 輸入學生總表的 Google Sheets ID
   - 系統自動提取所有英文老師資訊
   - 確認老師清單和對應的班級、學生數
3. **自動建立和匯入**：
   - 系統為每位老師建立專屬記錄簿
   - 自動匯入對應的學生資料
   - 科目自動設定為「英文」

### 新增單一老師記錄簿

1. 點選選單中的「👨‍🏫 新增老師記錄簿」
2. 依序輸入：
   - 老師姓名
   - 授課班級（用逗號分隔，如：701,702,703）
   
   **注意**：科目自動設定為「英文」，無需手動輸入

3. 系統自動建立包含以下工作表的記錄簿：
   - **總覽**：基本資訊和統計概要
   - **班級資訊**：班級基本資料
   - **學生清單**：學生和家長聯絡資訊
   - **電聯記錄**：實際聯繫記錄
   - **進度追蹤**：學期進度統計

### 電聯記錄填寫

1. 開啟老師專屬記錄簿
2. 切換到「電聯記錄」工作表
3. 填寫記錄內容：
   - **Student ID**：學生ID（可從學生清單自動填入）
   - **Name**：學生中文姓名
   - **English Name**：學生英文姓名
   - **English Class**：英語班級（下拉選單選擇）
   - **Date**：聯繫日期（自動驗證格式）
   - **Teachers Content**：老師談話內容和記錄
   - **Parents Responses**：家長回應和反饋
   - **Contact**：聯絡方式（Phone Call, SMS, Line, Email, Home Visit, In Person, Other）

### 快速新增電聯記錄

使用「快速新增電聯記錄」功能可以：
1. 從學生清單中選擇學生
2. 自動填入學生基本資料（ID、姓名、班級）
3. 自動填入當前日期
4. 聚焦到Teachers Content欄位，方便直接輸入聯繫內容

### 系統設定查看

**Dashboard 系統設定功能**
1. 在 Dashboard 中點選「⚙️ 系統設定」按鈕
2. 查看完整的系統設定資訊，包括：
   - **系統狀態**：健康度、初始化狀態、狀態描述
   - **資料夾設定**：主資料夾、老師資料夾、範本資料夾配置
   - **學年設定**：學期、期別、當前學期和期別
   - **聯繫設定**：聯繫類型、聯繫方式、必須聯繫次數、提醒天數
   - **年級設定**：年級層級、英語班級名稱
3. 可直接開啟主資料夾連結
4. 所有設定資訊以視覺化方式呈現，方便查看和確認

**Google Sheets 選單方式（替代方案）**
1. 選擇「系統管理」→「⚙️ 系統設定」
2. 查看當前系統設定摘要
3. 如需修改設定，可前往管理控制台

### 學生資料管理

**Dashboard 學生資料匯入/匯出**
1. 在 Dashboard 中點選「📥 匯入學生資料」或「📤 匯出學生資料」
2. 系統自動處理資料匯入和匯出
3. 支援完整的學生資料管理功能

**Google Sheets 選單方式（替代方案）**
1. 選擇「學生資料管理」→「匯入學生資料」
2. 選擇要匯入的老師記錄簿
3. 選擇資料來源：
   - 從Google Sheets匯入：輸入包含學生總表的Sheets ID
   - 手動輸入：逐一輸入學生資料
4. 系統自動匯入並設定資料驗證

**學生總表格式要求**
- 標題列必須包含：ID, Grade, HR, Seat #, Chinese Name, English Name, 112 Level, 113 Level, English Class (Old), English Class, **LT**, Mother's Phone, Father's Phone
- **LT 欄位**：Local Teacher，本地老師姓名（用於自動提取老師資訊）
- **HR 欄位**：Home Room，班級資訊（用於自動分配學生）
- 系統會自動驗證格式並提醒缺少的欄位

### 傳統批次建立記錄簿

1. 準備包含老師資料的 Google Sheets
2. 格式：老師姓名 | 授課班級（科目自動設定為「英文」）
3. 選擇「📝 批次建立老師記錄簿」
4. 輸入試算表 ID
5. 系統自動為所有老師建立記錄簿

**注意**：推薦使用「從學生總表建立老師記錄簿」功能，可以同時建立記錄簿並匯入學生資料。

---

# 🎯 客製化說明

## 📊 系統格式

### 學生總表格式
```
ID | Grade | HR | Seat # | Chinese Name | English Name | 112 Level | 113 Level | English Class (Old) | English Class | LT | Mother's Phone | Father's Phone
```

### 電聯記錄格式
```
Student ID | Name | English Name | English Class | Date | Semester | Term | Contact Type | Teachers Content | Parents Responses | Contact Method
```

## ✅ 已完成的客製化調整

### 1. 林口康橋國際學校小學國際處專用優化
- **科目自動設定**：系統自動將所有老師科目設定為「英文」，無需重複輸入
- **LT 欄位智能識別**：自動從學生總表的 LT（Local Teacher）欄位提取本地老師資訊
- **一鍵批量建立**：從學生總表自動為所有英文老師建立記錄簿並匯入對應學生資料
- **Dashboard 管理面板**：提供視覺化操作介面，支援集中管理

### 2. 學生資料結構調整
- 學生清單工作表已調整為您的13個欄位格式
- 包含完整的學生資訊：ID、年級、班級、座號、中英文姓名、學年度等級、英語班級、語言測驗、父母電話等
- 自動設定資料驗證：年級下拉選單(7-12)、班級(HR)下拉選單
- **智能資料分配**：根據 LT 欄位自動將學生資料分配到對應老師的記錄簿

### 3. 電聯記錄結構調整
- 電聯記錄工作表已調整為學期制11個欄位格式
- 欄位順序：Student ID → Name → English Name → English Class → Date → Semester → Term → Contact Type → Teachers Content → Parents Responses → Contact Method
- 新增學期制欄位：Semester（學期）、Term（學期階段）、Contact Type（電聯類型）
- 支援學期進度追蹤和電聯分類管理

### 4. 聯絡方式選項調整
調整為英文選項（v2.2 最新版本）：
- **Phone Call** - 電話聯繫
- **Line** - Line訊息
- **Email** - 電子郵件

**注意**：系統已簡化聯繫方式選項，移除較少使用的選項以提高操作效率。

### 5. 條件式格式調整
- **Phone Call**：藍色背景 (#D1ECF1)
- **Line**：綠色背景 (#D4EDDA)
- **Email**：黃色背景 (#FFF3CD)
- **Teachers Content** 和 **Parents Responses** 欄位自動文字換行

**更新說明**：條件式格式已配合最新聯繫方式選項進行調整。

### 6. 資料驗證調整
- **English Class** 欄位(第4欄)：英語班級下拉選單
- **Date** 欄位(第5欄)：日期格式驗證
- **Contact** 欄位(第8欄)：聯絡方式下拉選單
- **Grade** 欄位(第2欄)：年級選單(7-12)

### 7. 完成電聯驗證強化 (v2.2 新功能)
- **全欄位驗證**：「已完成電聯」統計現在檢查所有 11 個欄位 (A-K)
- **嚴格完整性檢查**：只有當所有必要欄位都填寫完整時，才計算為已完成電聯
- **即時進度更新**：進度追蹤表會即時反映完成狀態變化
- **品質保證**：確保每筆電聯記錄都包含完整資訊

**驗證欄位**：Student ID, Name, English Name, English Class, Date, Semester, Term, Contact Type, Teachers Content, Parents Responses, Contact Method

**重要性**：此更新確保電聯記錄的完整性和品質，提供更準確的進度追蹤。

## 🔧 新增功能

### 批量建立功能（林口康橋國際學校小學國際處專用）
- **從學生總表批量建立**：一鍵從學生總表建立所有英文老師的記錄簿
- **智能老師識別**：自動從 LT 欄位提取英文老師清單
- **自動資料分配**：為每位老師自動匯入對應的學生資料
- **建立進度追蹤**：即時顯示批量建立的進度和結果

### 學生資料匯入管理
- **從Google Sheets匯入**：可直接匯入您現有的學生總表
- **手動輸入功能**：逐一輸入學生資料
- **格式自動檢查**：驗證是否包含必要的13個欄位，特別檢查 LT 欄位
- **資料匯出功能**：將學生資料匯出為新的Google Sheets

### 快速電聯記錄建立
- 從學生清單中選擇學生
- 自動填入Student ID、Name、English Name、English Class
- 自動填入當前日期
- 直接定位到Teachers Content欄位開始輸入

### 系統驗證功能 (v2.2 新增)
- **完整系統驗證**：`runSystemValidation()` 函數提供全面的系統健康檢查
- **權限相容性檢查**：驗證 Google Drive 存取權限和檔案創建權限
- **功能完整性驗證**：檢查所有核心功能是否正常運作
- **新功能驗證**：驗證測試資料生成、預建電聯記錄、學年管理等功能
- **部署驗證**：`verifyDeployment()` 函數檢查所有必要函數是否正確部署

### 部署完整性檢查
- **關鍵函數檢查**：驗證所有核心、儀表板、工具、進度追蹤等函數
- **分類統計**：按功能類別顯示部署完整度
- **缺失函數警告**：明確指出需要重新部署的函數
- **Web版本支援**：提供Dashboard使用的Web版本驗證功能

### 進度檢查調整
- 日期檢查調整為第5欄(Date欄位)
- 班級統計調整為English Class欄位
- 聯絡方式統計調整為Contact欄位

## 📝 使用建議

### 林口康橋國際學校小學國際處推薦工作流程
1. **準備學生總表**：確保包含 LT 欄位和所有13個必要欄位
2. **一鍵批量建立**：使用「📋 從學生總表建立老師記錄簿」功能
3. **確認建立結果**：檢查所有英文老師的記錄簿和學生資料
4. **開始使用**：各老師開始使用各自的記錄簿進行電聯記錄

### 匯入現有學生資料（單一老師）
1. 準備您的學生總表Google Sheets
2. 確保第一列為標題列，包含所有13個欄位，特別是 LT 欄位
3. 使用「學生資料管理」→「匯入學生資料」功能
4. 輸入Sheets ID進行批次匯入

### 建立電聯記錄
1. 使用「快速新增電聯記錄」從學生清單選擇
2. 在Teachers Content欄位記錄老師的觀察、討論內容、建議等
3. 在Parents Responses欄位記錄家長的回應、承諾、說明等
4. 選擇適當的Contact聯絡方式

### 資料分析
- 系統會統計各English Class的學期電聯完成度
- 分析不同Contact方式的使用頻率
- 追蹤每個學期term的進度和趨勢

## ⚠️ 注意事項

1. **LT 欄位重要性**：學生總表中的 LT 欄位是批量建立功能的核心，請確保所有學生都有對應的英文老師資訊
2. **權限設定**：確保所有英文老師都有存取各自記錄簿的適當權限
3. **資料備份**：批量建立前建議先備份現有資料
4. **隱私保護**：學生個人資料(電話等)請注意隱私保護規範
5. **科目設定**：系統已自動設定科目為「英文」，如需修改請在程式碼中調整
6. **重複建立**：系統會檢查是否已存在相同老師的記錄簿，避免重複建立

---

# ✅ 安裝驗證清單

安裝完成後，請檢查以下項目：

### 基礎安裝驗證
- [ ] Google Drive 中存在「電聯記錄簿系統」資料夾
- [ ] 資料夾內包含 4 個子資料夾
- [ ] 存在「電聯記錄簿範本」檔案
- [ ] 存在「電聯記錄簿管理控制台」檔案
- [ ] 任意 Google Sheets 中顯示系統選單
- [ ] 選單包含「📋 從學生總表建立老師記錄簿」選項

### 功能驗證
- [ ] 能成功建立測試用的老師記錄簿
- [ ] 記錄簿包含 5 個工作表（總覽、班級資訊、學生清單、電聯記錄、進度追蹤）
- [ ] 工作表格式和功能正常
- [ ] 科目自動設定為「英文」（無需手動輸入）

### 批量建立功能驗證
- [ ] 準備好包含 LT 欄位的學生總表
- [ ] 能成功提取老師清單（從學生總表）
- [ ] 能批量建立多位老師的記錄簿
- [ ] 學生資料自動匯入到對應老師的記錄簿

### Dashboard 驗證（主要系統介面）
- [ ] Dashboard 介面正常顯示
- [ ] 各功能按鈕正常運作
- [ ] 統計資料正確顯示
- [ ] 系統設定功能完整顯示
- [ ] 批量建立功能正常運作
- [ ] 學生資料匯入/匯出功能正常運作
- [ ] 所有功能都能在Dashboard中完成，無需切換環境

### 系統驗證功能驗證 (v2.2 新增)
- [ ] 能執行 `runSystemValidation()` 函數進行系統健康檢查
- [ ] 權限相容性檢查通過（Google Drive 存取、檔案創建等）
- [ ] 功能完整性驗證通過（核心功能、設定完整性等）
- [ ] 新功能驗證通過（測試資料生成、預建電聯記錄等）
- [ ] 能執行 `verifyDeployment()` 函數檢查部署完整性
- [ ] 所有關鍵函數都已正確部署
- [ ] 「已完成電聯」驗證所有11個欄位正常運作

---

# 🚨 常見問題

## 安裝問題

### Q: 權限授權失敗
**症狀**：顯示「授權失敗」或「存取被拒」
**解決方案**：
1. 檢查 Google 帳號是否有管理員權限
2. 清除瀏覽器快取和 Cookie
3. 使用無痕模式重試
4. 確認帳號沒有被企業政策限制

### Q: 選單沒有顯示
**症狀**：Google Sheets 中看不到系統選單
**解決方案**：
1. 重新整理 Google Sheets 頁面
2. 檢查 `onOpen` 函數是否正確
3. 確認權限授權完成
4. 等待 1-2 分鐘讓系統同步

### Q: 初始化失敗
**症狀**：執行 `initializeSystem` 時出現錯誤
**解決方案**：
1. 檢查 Google Drive 剩餘空間
2. 確認所有程式碼都正確複製
3. 檢查是否有語法錯誤
4. 逐步執行子函數找出問題

## 使用問題

### Q: 如何從學生總表批量建立所有英文老師的記錄簿？

A: 使用「📋 從學生總表建立老師記錄簿」功能，系統會自動從學生總表的 LT 欄位提取所有英文老師，並為每位老師建立記錄簿和匯入對應學生資料。

### Q: 為什麼建立老師記錄簿時不需要輸入科目？

A: 系統已針對林口康橋國際學校小學國際處優化，自動將所有老師的科目設定為「英文」，簡化操作流程。

### Q: LT 欄位在學生總表中的作用是什麼？

A: LT（Local Teacher）欄位用於識別每位學生的本地老師，系統會根據此欄位自動提取老師清單並分配學生資料到對應的記錄簿。

### Q: 無法從學生總表提取老師資訊
**症狀**：執行「從學生總表建立老師記錄簿」時提示找不到老師資訊
**解決方案**：
1. 確認學生總表包含 LT 欄位（Local Teacher）
2. 檢查 LT 欄位中有填入老師姓名
3. 確認學生總表的 Google Sheets ID 正確
4. 檢查是否有該檔案的讀取權限

### Q: 批量建立部分失敗
**症狀**：有些老師記錄簿建立成功，有些失敗
**解決方案**：
1. 檢查失敗老師的姓名是否包含特殊字元
2. 確認每位老師都有對應的學生資料
3. 檢查 Google Drive 儲存空間
4. 重新執行，系統會跳過已建立的記錄簿

### Q: Dashboard 功能異常
**症狀**：Dashboard 按鈕點擊無反應或出現錯誤
**解決方案**：
1. 確認已正確設定 Google Apps Script 網址
2. 檢查瀏覽器是否阻擋跨域請求
3. 確認 Google Apps Script 權限設定正確
4. 重新整理 Dashboard 頁面
5. 檢查網路連線狀態

### Q: 系統設定功能如何使用？

A: 在 Dashboard 中點選「⚙️ 系統設定」按鈕，可以查看完整的系統設定資訊，包括系統狀態、資料夾配置、學年設定、聯繫設定等。所有資訊以視覺化方式呈現，方便查看和確認。

### Q: Dashboard 和 Google Sheets 選單有什麼差別？

A: Dashboard 提供統一的 Web 介面，是系統的主要操作方式。所有功能都可以在瀏覽器中直接執行，無需切換環境。相較之下，Google Sheets 選單是作為替代方案保留，主要用於向後兼容。推薦使用 Dashboard 以獲得最佳的用戶體驗。

### Q: 如何修改電聯記錄的欄位？

A: 修改 `SYSTEM_CONFIG.CONTACT_FIELDS` 陣列，然後重新建立範本。

### Q: 如何為現有記錄簿新增學生資料？

A: 推薦使用 Dashboard 的「📥 匯入學生資料」功能，提供完整的Web介面操作。如需要，也可以透過 Google Sheets 選單「學生資料管理」→「匯入學生資料」功能作為替代方案。兩種方式都支援從現有學生總表批次匯入，或手動逐一新增。

### Q: 學生總表的格式要求是什麼？

A: 標題列應包含：ID, Grade, HR, Seat #, Chinese Name, English Name, 112 Level, 113 Level, English Class (Old), English Class, **LT**, Mother's Phone, Father's Phone。其中 LT 欄位是必須的，用於識別英文老師。

### Q: 如何快速建立電聯記錄？

A: 在電聯記錄工作表中，使用「學生資料管理」→「快速新增電聯記錄」，可以從學生清單選擇學生並自動填入基本資料。

### Q: Dashboard 管理面板如何使用？

A: Dashboard 是系統的主要操作界面，開啟 Dashboard Web 應用程式 URL 後，可以透過統一的視覺化介面執行所有功能，包括：
- 系統初始化和狀態檢查
- 從學生總表批量建立老師記錄簿
- 學生資料匯入和匯出
- 系統設定查看
- 進度檢查和系統管理
所有功能都整合在單一介面中，提供完整一致的用戶體驗，這是推薦的主要操作方式。

### Q: 如何使用系統驗證功能？

A: 在 Google Apps Script 編輯器中執行 `runSystemValidation()` 函數，系統會自動檢查權限相容性、功能完整性和新功能驗證。檢查完成後會顯示詳細的驗證結果報告。

### Q: 如何檢查系統部署完整性？

A: 執行 `verifyDeployment()` 函數可以檢查所有關鍵函數是否正確部署。函數會按類別顯示部署狀態，並指出需要重新部署的函數。

### Q: 「已完成電聯」統計不準確怎麼辦？

A: v2.2 版本已強化完成電聯驗證，現在檢查所有 11 個欄位。如果統計仍不準確，請確認：
1. 所有必要欄位都已填寫完整
2. 沒有多餘的空格或格式問題
3. Contact Type 設定為 "Scheduled Contact"
4. 學期和 Term 設定正確

### Q: 如何設定通知功能？

A: 在 `sendProgressAlert` 函數中新增 Gmail 通知程式碼。

---

# 📞 技術支援

## 系統需求

- Google Apps Script 環境
- Google Drive 存取權限
- Google Sheets 操作權限

## 聯絡方式

如遇技術問題，請聯繫系統管理員或參考 Google Apps Script 官方文件。

## 系統資訊

- **版本**：2.2（完整驗證強化版）
- **開發日期**：2024年
- **相容性**：Google Apps Script V8 Runtime
- **架構特色**：統一Web環境、完整Dashboard功能、無環境切換困擾
- **核心功能**：一鍵批量建立、智能資料提取、系統設定視覺化、完整Web功能支援
- **v2.2 新增功能**：
  - 完成電聯驗證強化（檢查所有11個欄位）
  - 系統驗證功能（權限、功能完整性檢查）
  - 部署完整性檢查
  - 聯繫方式選項優化
  - 測試資料生成功能

## 📄 授權

**製作人**: 陳則宏 Jason Chen  
**學校**: 林口康橋國際學校 小學國際處 (KCISLK ESID)

本專案採用 MIT 授權條款。

## 🔄 更新歷史

### v2.2 (2024年) - 完整驗證強化版
- ✅ **完成電聯驗證強化**：「已完成電聯」統計現在檢查所有11個欄位
- ✅ **系統驗證功能**：新增 `runSystemValidation()` 完整系統健康檢查
- ✅ **部署完整性檢查**：新增 `verifyDeployment()` 函數部署狀態檢查
- ✅ **聯繫方式優化**：簡化為Phone Call、Line、Email三種選項
- ✅ **測試資料生成**：強化測試資料生成和預建電聯記錄功能
- ✅ **文檔更新**：更新使用手冊和新增測試手冊

### v2.1 (2024年) - 統一Dashboard架構版
- ✅ **統一Web環境**：所有功能整合至Dashboard，無需環境切換
- ✅ **完整Dashboard功能**：Web版本功能與原有功能完全一致
- ✅ **系統設定視覺化**：可視化查看所有系統配置和狀態
- ✅ **批量建立優化**：從學生總表自動建立所有英文老師記錄簿
- ✅ **智能資料分配**：根據LT欄位自動分配學生到對應老師

---

**電聯記錄簿管理系統** - 專為林口康橋國際學校小學國際處打造，讓電聯工作更輕鬆，讓家校溝通更有效！

### 🌟 林口康橋國際學校小學國際處專用特色
- 🚀 **一鍵批量建立**：從學生總表自動建立所有英文老師記錄簿
- 🎯 **智能資料分配**：根據 LT 欄位自動分配學生到對應老師
- 🎨 **統一Dashboard管理**：完整的視覺化管理介面，無需環境切換
- ⚡ **簡化操作**：科目自動設定，操作更簡潔
- 🔧 **系統設定視覺化**：可視化查看所有系統配置和狀態
- 📊 **完整Web功能**：所有功能均支援Web版本，提供一致的用戶體驗

**系統已完全針對林口康橋國際學校小學國際處進行深度客製化，採用統一的Dashboard架構，支援一鍵批量建立和智能資料管理，提供完整的Web環境體驗！** 🎉

---

**🏫 製作人**: 陳則宏 Jason Chen | **🎯 專為**: 林口康橋國際學校小學國際處 (KCISLK ESID)