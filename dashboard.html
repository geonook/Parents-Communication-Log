<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»è¯è¨˜éŒ„ç°¿ç³»çµ± - ç®¡ç†é¢æ¿</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .main-content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 25px;
            border-radius: 10px;
            background: #f8f9fa;
            border-left: 5px solid #4facfe;
        }
        
        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .action-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 80px;
        }
        
        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .action-button.primary {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }
        
        .action-button.secondary {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #4facfe;
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #666;
            font-size: 1em;
        }
        
        .instructions {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .instructions h3 {
            color: #1976d2;
            margin-bottom: 15px;
        }
        
        .instructions ol {
            padding-left: 20px;
            line-height: 1.6;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            border-top: 1px solid #eee;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            position: relative;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            right: 20px;
            top: 20px;
            cursor: pointer;
        }
        
        .close:hover {
            color: #000;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
        }
        
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            resize: vertical;
            min-height: 100px;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .button-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“š é›»è¯è¨˜éŒ„ç°¿ç³»çµ±</h1>
            <p>ä¸­å¸«è‹±æ–‡ç§‘ç®¡ç†é¢æ¿</p>
        </div>
        
        <div class="main-content">
            <!-- ç³»çµ±çµ±è¨ˆ -->
            <div class="section">
                <h2>ğŸ“Š ç³»çµ±æ¦‚æ³</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="teacherCount">0</div>
                        <div class="stat-label">è‹±æ–‡è€å¸«</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="studentCount">0</div>
                        <div class="stat-label">å­¸ç”Ÿç¸½æ•¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="contactCount">0</div>
                        <div class="stat-label">é›»è¯è¨˜éŒ„</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="monthlyProgress">0%</div>
                        <div class="stat-label">æœ¬æœˆé€²åº¦</div>
                    </div>
                </div>
            </div>
            
            <!-- ä¸»è¦åŠŸèƒ½ -->
            <div class="section">
                <h2>ğŸš€ ä¸»è¦åŠŸèƒ½</h2>
                <div class="button-grid">
                    <button class="action-button primary" onclick="showMasterListModal()">
                        ğŸ“‹ å¾å­¸ç”Ÿç¸½è¡¨å»ºç«‹è€å¸«è¨˜éŒ„ç°¿
                    </button>
                    <button class="action-button" onclick="initializeSystem()">
                        ğŸ—ï¸ åˆå§‹åŒ–ç³»çµ±
                    </button>
                    <button class="action-button" onclick="showTeacherModal()">
                        ğŸ‘¨â€ğŸ« æ–°å¢å–®ä¸€è€å¸«è¨˜éŒ„ç°¿
                    </button>
                    <button class="action-button secondary" onclick="openSystemFolder()">
                        ğŸ“ é–‹å•Ÿç³»çµ±è³‡æ–™å¤¾
                    </button>
                </div>
            </div>
            
            <!-- è³‡æ–™ç®¡ç† -->
            <div class="section">
                <h2>ğŸ“ è³‡æ–™ç®¡ç†</h2>
                <div class="button-grid">
                    <button class="action-button" onclick="importStudentData()">
                        ğŸ“¥ åŒ¯å…¥å­¸ç”Ÿè³‡æ–™
                    </button>
                    <button class="action-button" onclick="exportStudentData()">
                        ğŸ“¤ åŒ¯å‡ºå­¸ç”Ÿè³‡æ–™
                    </button>
                    <button class="action-button" onclick="updateTeachersList()">
                        ğŸ”„ æ›´æ–°è€å¸«åˆ—è¡¨
                    </button>
                    <button class="action-button secondary" onclick="checkAllProgress()">
                        ğŸ“Š æª¢æŸ¥å…¨é«”é€²åº¦
                    </button>
                </div>
            </div>
            
            <!-- ç³»çµ±ç®¡ç† -->
            <div class="section">
                <h2>âš™ï¸ ç³»çµ±ç®¡ç†</h2>
                <div class="button-grid">
                    <button class="action-button" onclick="setupAutomation()">
                        ğŸ”„ è¨­å®šè‡ªå‹•åŒ–
                    </button>
                    <button class="action-button" onclick="performBackup()">
                        ğŸ’¾ æ‰‹å‹•å‚™ä»½
                    </button>
                    <button class="action-button secondary" onclick="checkFileIntegrity()">
                        ğŸ” æª¢æŸ¥æª”æ¡ˆå®Œæ•´æ€§
                    </button>
                    <button class="action-button secondary" onclick="showSystemSettings()">
                        âš™ï¸ ç³»çµ±è¨­å®š
                    </button>
                </div>
            </div>
            
            <!-- ä½¿ç”¨èªªæ˜ -->
            <div class="section">
                <h2>ğŸ“– ä½¿ç”¨èªªæ˜</h2>
                <div class="instructions">
                    <h3>å¿«é€Ÿé–‹å§‹æŒ‡å—ï¼š</h3>
                    <ol>
                        <li><strong>ç³»çµ±åˆå§‹åŒ–ï¼š</strong>é¦–æ¬¡ä½¿ç”¨è«‹é»æ“Šã€Œåˆå§‹åŒ–ç³»çµ±ã€å»ºç«‹åŸºæœ¬è³‡æ–™å¤¾çµæ§‹</li>
                        <li><strong>æ‰¹é‡å»ºç«‹ï¼š</strong>æº–å‚™å­¸ç”Ÿç¸½è¡¨ï¼ˆåŒ…å« LT æ¬„ä½ï¼‰ï¼Œä½¿ç”¨ã€Œå¾å­¸ç”Ÿç¸½è¡¨å»ºç«‹è€å¸«è¨˜éŒ„ç°¿ã€åŠŸèƒ½</li>
                        <li><strong>è³‡æ–™åŒ¯å…¥ï¼š</strong>ç³»çµ±æœƒè‡ªå‹•å¾å­¸ç”Ÿç¸½è¡¨æå–å„è€å¸«å°æ‡‰çš„å­¸ç”Ÿè³‡æ–™</li>
                        <li><strong>æ—¥å¸¸ä½¿ç”¨ï¼š</strong>è€å¸«å€‘å¯ç›´æ¥åœ¨å„è‡ªçš„è¨˜éŒ„ç°¿ä¸­é€²è¡Œé›»è¯è¨˜éŒ„</li>
                        <li><strong>é€²åº¦è¿½è¹¤ï¼š</strong>ä½¿ç”¨ã€Œæª¢æŸ¥å…¨é«”é€²åº¦ã€ç›£æ§æ•´é«”é›»è¯æƒ…æ³</li>
                    </ol>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Â© 2024 é›»è¯è¨˜éŒ„ç°¿ç³»çµ± - å°ˆç‚ºä¸­å¸«è‹±æ–‡ç§‘è¨­è¨ˆ</p>
        </div>
    </div>

    <!-- å­¸ç”Ÿç¸½è¡¨åŒ¯å…¥æ¨¡æ…‹æ¡† -->
    <div id="masterListModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ğŸ“‹ å¾å­¸ç”Ÿç¸½è¡¨å»ºç«‹è€å¸«è¨˜éŒ„ç°¿</h2>
            <div class="form-group">
                <label for="masterListId">å­¸ç”Ÿç¸½è¡¨ Google Sheets IDï¼š</label>
                <input type="text" id="masterListId" placeholder="è«‹è¼¸å…¥ Google Sheets çš„å®Œæ•´ ID">
                <small style="color: #666; display: block; margin-top: 5px;">
                    ç¯„ä¾‹ï¼šå¾ https://docs.google.com/spreadsheets/d/1ABC...XYZ/edit ä¸­è¤‡è£½ 1ABC...XYZ éƒ¨åˆ†
                </small>
            </div>
            <div class="form-group">
                <label>ç³»çµ±è¦æ±‚ï¼š</label>
                <ul style="padding-left: 20px; color: #666;">
                    <li>å­¸ç”Ÿç¸½è¡¨å¿…é ˆåŒ…å« LT (Language Teacher) æ¬„ä½</li>
                    <li>åŒ…å« HR (Home Room) æ¬„ä½ç”¨æ–¼ç­ç´šè³‡è¨Š</li>
                    <li>åŒ…å«å­¸ç”ŸåŸºæœ¬è³‡æ–™æ¬„ä½</li>
                </ul>
            </div>
            <div style="text-align: right; margin-top: 20px;">
                <button class="action-button" onclick="processMasterList()" style="margin-right: 10px;">
                    é–‹å§‹è™•ç†
                </button>
                <button class="action-button secondary" onclick="closeMasterListModal()">
                    å–æ¶ˆ
                </button>
            </div>
        </div>
    </div>

    <!-- æ–°å¢è€å¸«æ¨¡æ…‹æ¡† -->
    <div id="teacherModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ğŸ‘¨â€ğŸ« æ–°å¢è€å¸«è¨˜éŒ„ç°¿</h2>
            <div class="form-group">
                <label for="teacherName">è€å¸«å§“åï¼š</label>
                <input type="text" id="teacherName" placeholder="è«‹è¼¸å…¥è€å¸«å§“å">
            </div>
            <div class="form-group">
                <label for="teacherClasses">æˆèª²ç­ç´šï¼š</label>
                <input type="text" id="teacherClasses" placeholder="ä¾‹å¦‚ï¼š701,702,703ï¼ˆç”¨é€—è™Ÿåˆ†éš”ï¼‰">
            </div>
            <div style="text-align: right; margin-top: 20px;">
                <button class="action-button" onclick="createSingleTeacher()" style="margin-right: 10px;">
                    å»ºç«‹è¨˜éŒ„ç°¿
                </button>
                <button class="action-button secondary" onclick="closeTeacherModal()">
                    å–æ¶ˆ
                </button>
            </div>
        </div>
    </div>

    <script>
        // Google Apps Script éƒ¨ç½²é…ç½®
        const SYSTEM_CONFIG = {
            MAIN_FOLDER_ID: '1ksWywUMUfsmHtUq99HdRB34obcAXhKUX',
            // ä¸éœ€è¦ SCRIPT_URLï¼Œç›´æ¥ä½¿ç”¨ google.script.run
        };

        // æ¨¡æ…‹æ¡†æ§åˆ¶
        function showMasterListModal() {
            document.getElementById('masterListModal').style.display = 'block';
        }

        function closeMasterListModal() {
            document.getElementById('masterListModal').style.display = 'none';
        }

        function showTeacherModal() {
            document.getElementById('teacherModal').style.display = 'block';
        }

        function closeTeacherModal() {
            document.getElementById('teacherModal').style.display = 'none';
        }

        // é»æ“Šæ¨¡æ…‹æ¡†å¤–éƒ¨é—œé–‰
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // é—œé–‰æŒ‰éˆ•äº‹ä»¶
        document.querySelectorAll('.close').forEach(closeBtn => {
            closeBtn.onclick = function() {
                this.closest('.modal').style.display = 'none';
            }
        });

        // ä¸»è¦åŠŸèƒ½å‡½æ•¸
        function processMasterList() {
            const sheetId = document.getElementById('masterListId').value.trim();
            
            if (!sheetId) {
                alert('è«‹è¼¸å…¥å­¸ç”Ÿç¸½è¡¨çš„ Google Sheets ID');
                return;
            }
            
            // é¡¯ç¤ºè™•ç†ä¸­ç‹€æ…‹
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'è™•ç†ä¸­...';
            button.disabled = true;
            
            // ç›®å‰éœ€è¦åœ¨ Google Sheets ä¸­åŸ·è¡Œæ­¤åŠŸèƒ½
            alert('è«‹åœ¨ Google Sheets ä¸­ä½¿ç”¨ã€Œé›»è¯è¨˜éŒ„ç°¿ç³»çµ±ã€é¸å–® â†’ ã€ŒğŸ“‹ å¾å­¸ç”Ÿç¸½è¡¨å»ºç«‹è€å¸«è¨˜éŒ„ç°¿ã€åŠŸèƒ½\n\nå­¸ç”Ÿç¸½è¡¨ IDï¼š' + sheetId);
            
            button.textContent = originalText;
            button.disabled = false;
            closeMasterListModal();
        }

        function createSingleTeacher() {
            const name = document.getElementById('teacherName').value.trim();
            const classes = document.getElementById('teacherClasses').value.trim();
            
            if (!name || !classes) {
                alert('è«‹å¡«å¯«å®Œæ•´çš„è€å¸«è³‡è¨Š');
                return;
            }
            
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'å»ºç«‹ä¸­...';
            button.disabled = true;
            
            // æº–å‚™è³‡æ–™
            const formData = {
                action: 'createSingleTeacher',
                teacherName: name,
                teacherClasses: classes
            };
            
            google.script.run
                .withSuccessHandler(function(result) {
                    button.textContent = originalText;
                    button.disabled = false;
                    closeTeacherModal();
                    if (result.success) {
                        alert('è€å¸«è¨˜éŒ„ç°¿å»ºç«‹æˆåŠŸï¼\n' + result.message);
                        if (result.recordBookUrl) {
                            if (confirm('æ˜¯å¦è¦é–‹å•Ÿæ–°å»ºç«‹çš„è¨˜éŒ„ç°¿ï¼Ÿ')) {
                                window.open(result.recordBookUrl, '_blank');
                            }
                        }
                    } else {
                        alert('å»ºç«‹å¤±æ•—ï¼š' + result.message);
                    }
                    updateStats();
                })
                .withFailureHandler(function(error) {
                    button.textContent = originalText;
                    button.disabled = false;
                    alert('å»ºç«‹å¤±æ•—ï¼š' + error.message);
                })
                .createSingleTeacherWeb(formData);
        }

        function initializeSystem() {
            if (confirm('ç¢ºå®šè¦åˆå§‹åŒ–ç³»çµ±å—ï¼Ÿé€™å°‡å»ºç«‹å¿…è¦çš„è³‡æ–™å¤¾çµæ§‹ã€‚')) {
                google.script.run
                    .withSuccessHandler(function(result) {
                        if (result.success) {
                            alert('ç³»çµ±åˆå§‹åŒ–å®Œæˆï¼\n' + result.message);
                            
                            // æä¾›å¤šå€‹é¸é …è®“ä½¿ç”¨è€…é¸æ“‡è¦é–‹å•Ÿçš„æª”æ¡ˆ
                            const options = [];
                            if (result.mainFolderUrl) options.push('ç³»çµ±ä¸»è³‡æ–™å¤¾');
                            if (result.masterListUrl) options.push('å­¸ç”Ÿç¸½è¡¨');
                            if (result.adminSheetUrl) options.push('ç®¡ç†æ§åˆ¶å°');
                            
                            if (options.length > 0) {
                                const choice = prompt('é¸æ“‡è¦é–‹å•Ÿçš„æª”æ¡ˆï¼š\n1. ç³»çµ±ä¸»è³‡æ–™å¤¾\n2. å­¸ç”Ÿç¸½è¡¨ï¼ˆå»ºè­°å…ˆé–‹å•Ÿé€™å€‹ï¼‰\n3. ç®¡ç†æ§åˆ¶å°\n\nè«‹è¼¸å…¥æ•¸å­— (1-3)ï¼š');
                                
                                switch(choice) {
                                    case '1':
                                        if (result.mainFolderUrl) window.open(result.mainFolderUrl, '_blank');
                                        break;
                                    case '2':
                                        if (result.masterListUrl) window.open(result.masterListUrl, '_blank');
                                        break;
                                    case '3':
                                        if (result.adminSheetUrl) window.open(result.adminSheetUrl, '_blank');
                                        break;
                                }
                            }
                        } else {
                            alert('åˆå§‹åŒ–å¤±æ•—ï¼š' + result.message);
                        }
                    })
                    .withFailureHandler(function(error) {
                        alert('åˆå§‹åŒ–å¤±æ•—ï¼š' + error.message);
                    })
                    .initializeSystemWeb();
            }
        }

        function openSystemFolder() {
            google.script.run
                .withSuccessHandler(function(result) {
                    if (result.success) {
                        window.open(result.url, '_blank');
                    } else {
                        alert('ç„¡æ³•é–‹å•Ÿç³»çµ±è³‡æ–™å¤¾ï¼š' + result.message);
                    }
                })
                .withFailureHandler(function(error) {
                    alert('é–‹å•Ÿè³‡æ–™å¤¾å¤±æ•—ï¼š' + error.message);
                })
                .getSystemFolderUrl();
        }

        function importStudentData() {
            alert('è«‹åœ¨ Google Sheets ä¸­ä½¿ç”¨ã€Œé›»è¯è¨˜éŒ„ç°¿ç³»çµ±ã€é¸å–® â†’ ã€Œå­¸ç”Ÿè³‡æ–™ç®¡ç†ã€â†’ ã€ŒğŸ“¥ åŒ¯å…¥å­¸ç”Ÿè³‡æ–™ã€åŠŸèƒ½');
        }

        function exportStudentData() {
            alert('è«‹åœ¨ Google Sheets ä¸­ä½¿ç”¨ã€Œé›»è¯è¨˜éŒ„ç°¿ç³»çµ±ã€é¸å–® â†’ ã€Œå­¸ç”Ÿè³‡æ–™ç®¡ç†ã€â†’ ã€ŒğŸ“¤ åŒ¯å‡ºå­¸ç”Ÿè³‡æ–™ã€åŠŸèƒ½');
        }

        function updateTeachersList() {
            google.script.run
                .withSuccessHandler(function(result) {
                    if (result.success) {
                        alert('è€å¸«åˆ—è¡¨æ›´æ–°å®Œæˆï¼');
                        updateStats();
                    } else {
                        alert('æ›´æ–°å¤±æ•—ï¼š' + result.message);
                    }
                })
                .withFailureHandler(function(error) {
                    alert('æ›´æ–°å¤±æ•—ï¼š' + error.message);
                })
                .executeSystemFunction('updateTeachersList');
        }

        function checkAllProgress() {
            google.script.run
                .withSuccessHandler(function(result) {
                    if (result.success) {
                        alert('é€²åº¦æª¢æŸ¥å®Œæˆï¼');
                    } else {
                        alert('æª¢æŸ¥å¤±æ•—ï¼š' + result.message);
                    }
                })
                .withFailureHandler(function(error) {
                    alert('æª¢æŸ¥å¤±æ•—ï¼š' + error.message);
                })
                .executeSystemFunction('checkAllProgress');
        }

        function setupAutomation() {
            google.script.run
                .withSuccessHandler(function(result) {
                    if (result.success) {
                        alert('è‡ªå‹•åŒ–è¨­å®šå®Œæˆï¼');
                    } else {
                        alert('è¨­å®šå¤±æ•—ï¼š' + result.message);
                    }
                })
                .withFailureHandler(function(error) {
                    alert('è¨­å®šå¤±æ•—ï¼š' + error.message);
                })
                .executeSystemFunction('setupAutomation');
        }

        function performBackup() {
            google.script.run
                .withSuccessHandler(function(result) {
                    if (result.success) {
                        alert('å‚™ä»½å®Œæˆï¼');
                    } else {
                        alert('å‚™ä»½å¤±æ•—ï¼š' + result.message);
                    }
                })
                .withFailureHandler(function(error) {
                    alert('å‚™ä»½å¤±æ•—ï¼š' + error.message);
                })
                .executeSystemFunction('performBackup');
        }

        function checkFileIntegrity() {
            google.script.run
                .withSuccessHandler(function(result) {
                    if (result.success) {
                        alert('æª”æ¡ˆå®Œæ•´æ€§æª¢æŸ¥å®Œæˆï¼');
                    } else {
                        alert('æª¢æŸ¥å¤±æ•—ï¼š' + result.message);
                    }
                })
                .withFailureHandler(function(error) {
                    alert('æª¢æŸ¥å¤±æ•—ï¼š' + error.message);
                })
                .executeSystemFunction('checkFileIntegrity');
        }

        function showSystemSettings() {
            alert('è«‹åœ¨ Google Sheets ä¸­ä½¿ç”¨ã€Œé›»è¯è¨˜éŒ„ç°¿ç³»çµ±ã€é¸å–® â†’ ã€Œç³»çµ±ç®¡ç†ã€â†’ ã€Œâš™ï¸ ç³»çµ±è¨­å®šã€åŠŸèƒ½');
        }

        // æ›´æ–°çµ±è¨ˆè³‡æ–™
        function updateStats() {
            google.script.run
                .withSuccessHandler(function(result) {
                    if (result.success) {
                        const stats = result.stats;
                        document.getElementById('teacherCount').textContent = stats.teacherCount;
                        document.getElementById('studentCount').textContent = stats.studentCount;
                        document.getElementById('contactCount').textContent = stats.contactCount;
                        document.getElementById('monthlyProgress').textContent = stats.monthlyProgress;
                    } else {
                        // ä½¿ç”¨é è¨­å€¼
                        document.getElementById('teacherCount').textContent = '0';
                        document.getElementById('studentCount').textContent = '0';
                        document.getElementById('contactCount').textContent = '0';
                        document.getElementById('monthlyProgress').textContent = '0%';
                    }
                })
                .withFailureHandler(function(error) {
                    // ç™¼ç”ŸéŒ¯èª¤æ™‚ä½¿ç”¨é è¨­å€¼
                    document.getElementById('teacherCount').textContent = '0';
                    document.getElementById('studentCount').textContent = '0';
                    document.getElementById('contactCount').textContent = '0';
                    document.getElementById('monthlyProgress').textContent = '0%';
                })
                .getSystemStatsWeb();
        }

        // é é¢è¼‰å…¥æ™‚æ›´æ–°çµ±è¨ˆ
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
        });
    </script>
</body>
</html>